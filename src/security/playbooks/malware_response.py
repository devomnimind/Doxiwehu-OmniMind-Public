"""Playbook for malware detection scan and cleanup."""
import logging
from typing import Dict, List

from .utils import run_command

logger = logging.getLogger(__name__)


def malware_response(event_details: Dict) -> Dict[str, List[Dict[str, str]]]:
    """Scan critical directories and quarantine suspicious files."""
    commands = [
        ["/usr/bin/clamscan", "-r", "/etc"],
        ["/usr/bin/clamscan", "-r", "/home"],
    ]
    executed = [run_command(cmd) for cmd in commands]
    logger.info("Malware playbook ran for %s", event_details.get("source"))
    return {
        "status": "completed",
        "commands": executed,
        "event": event_details,
    }
